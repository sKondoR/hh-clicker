# План реализации HH-clicker - приложения для автоматического просмотра вакансий на HeadHunter

## Цель проекта
Создать Next.js приложение с использованием Playwright для автоматического входа на сайт hh.ru, поиска вакансий по ключевому слову "java" и последующего просмотра вакансий до достижения 100% рейтинга активности.

## Архитектура приложения

### Структура проекта
```
hh-clicker/
├── src/
│   ├── pages/
│   │   ├── index.tsx          # Главная страница управления
│   │   ├── auth.tsx           # Страница авторизации
│   │   └── dashboard.tsx      # Панель управления процессом
│   ├── components/
│   │   ├── SearchControls.tsx # Элементы управления поиском
│   │   ├── ProgressTracker.tsx # Отслеживание прогресса
│   │   └── VacancyList.tsx    # Список вакансий
│   ├── lib/
│   │   ├── hh-scraper.ts      # Основной модуль скрапинга
│   │   ├── auth-handler.ts    # Обработка авторизации
│   │   └── storage.ts         # Хранилище учетных данных
│   ├── types/
│   │   └── hh-types.ts        # Типы данных для HH
│   └── utils/
│       ├── constants.ts       # Константы приложения
│       └── helpers.ts         # Вспомогательные функции
├── playwright/
│   ├── tests/
│   │   └── hh-flow.spec.ts    # Тесты сценариев работы
│   └── config/
│       └── playwright.config.ts
├── public/
├── package.json
├── next.config.js
├── tsconfig.json
└── README.md
```

## Подробное описание компонентов

### 1. Основные страницы

#### index.tsx (Главная страница)
- Интерфейс для запуска/остановки процесса сканирования
- Индикатор текущего состояния
- Кнопки управления
- Отображение прогресса

#### dashboard.tsx (Панель управления)
- Подробная информация о процессе сканирования
- Живое обновление статуса
- Лог событий
- Возможность настройки параметров сканирования

### 2. Компоненты интерфейса

#### SearchControls.tsx
- Поле для ввода ключевых слов поиска
- Кнопки запуска/паузы/останова процесса
- Настройка задержек между действиями
- Выбор региона поиска

#### ProgressTracker.tsx
- Визуальное отображение прогресса
- Текущий уровень активности
- Статистика по просмотренным вакансиям
- Предполагаемое время до достижения 100%

### 3. Бэкенд-логика

#### hh-scraper.ts
- Авторизация на сайте hh.ru
- Выполнение поискового запроса
- Открытие карточек вакансий
- Мониторинг изменения уровня активности
- Обработка каптч и анти-бот защит
- Управление браузерными сессиями

#### auth-handler.ts
- Обработка сессий
- Повторная авторизация при необходимости
- Обработка ошибок аутентификации

#### storage.ts
- Сохранение прогресса сканирования

### 4. Тестирование

#### hh-flow.spec.ts
- Тестирование полного цикла работы приложения
- Проверка корректности авторизации
- Тестирование поискового функционала
- Проверка отслеживания прогресса
- Тестирование обработки ошибок

## Технические требования

### Зависимости
- next: "^14.0.0"
- playwright: "^1.40.0"
- react: "^18.2.0"
- react-dom: "^18.2.0"
- typescript: "^5.0.0"
- puppeteer: "^21.0.0" (альтернатива Playwright)
- dotenv: "^16.3.1"
- crypto-browserify: "^3.12.0" (для шифрования)

### Безопасность
- Хранение учетных данных с шифрованием
- Защита от XSS и CSRF атак
- Использование безопасных HTTP заголовков
- Валидация и очистка всех пользовательских данных

### Производительность
- Оптимизация рендеринга компонентов
- Использование виртуального скроллинга для списков
- Кэширование частично загруженных данных
- Оптимизация изображений

## Алгоритм работы приложения

1. Пользователь вводит учетные данные и сохраняет их безопасно
2. Приложение запускает браузер через Playwright
3. Выполняется авторизация на сайте hh.ru
4. В строку поиска вводится "java"
5. Нажимается кнопка поиска
6. Приложение начинает открывать вакансии по одной
7. После каждого открытия проверяется уровень активности
8. Процесс продолжается до достижения 100% рейтинга активности
9. Пользователю отображается статус выполнения

## Особенности реализации

### Обход защиты от ботов
- Использование реальных user-agent строк
- Случайные задержки между действиями
- Имитация человеческого поведения при навигации
- Обработка cloudflare и других защит

### Определение уровня активности
- Анализ DOM элементов, содержащих информацию об уровне активности
- Поиск специфических классов или идентификаторов
- Периодическая проверка изменений
- Альтернативный способ через cookies или localStorage

### Обработка ошибок
- Повторные попытки при сетевых ошибках
- Обработка каптч и блокировок
- Корректное завершение сессии при ошибках
- Логирование всех ошибок для диагностики

## Развёртывание

### Локальный запуск
```bash
npm install
npm run dev
```

### Сборка для продакшена
```bash
npm run build
npm start
```

## Заключение

Этот план описывает создание безопасного и эффективного приложения для автоматического просмотра вакансий на HeadHunter. Архитектура позволяет масштабировать приложение и добавлять новые функции в будущем.